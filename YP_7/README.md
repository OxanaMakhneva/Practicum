# Учебный проект модуля "Численные методы". Определение рыночной стоимости атомобиля
Сервису по продаже автомобилей с пробегом «Не бит, не крашен» для внедрения в новое приложение требуется механизм, позволяющий рассчитать примерную рыночную стоимость автомобиля по его основным характеристикам.

## Цель проекта:
Подготовить модель расчета рыночной стоимости автомобиля пользователя для приложения заказчика. Модель требуется разработать на основании исследования исторических данных о ранее проданных автомобилях (предосталены в csv файле). Показателем качества модели принять RMSE, которая снизить до 2500. При выборе модели учесть:
- скорость обучения модели
- скорость предсказания модели
- точность предсказания

## Задачи проекта:
- подготовить данные
- построить минимум одну модель из семейства градиентного бустинга (LightGBM)
- построить несколько моделей, не использующих градиентный бустинг
- выбрать лучшую модель с учетом критериев, заданных заказчиком.
скорость обучения;
скорость предсказания;
точность предсказания.

## Описание данных:
- целевой признак - цена
- независимые признаки:
  - DateCrawled — дата скачивания анкеты из базы
  - VehicleType — тип автомобильного кузова
  - RegistrationYear — год регистрации автомобиля
  - Gearbox — тип коробки передач
  - Power — мощность (л. с.)
  - Model — модель автомобиля
  - Kilometer — пробег (км)
  - RegistrationMonth — месяц регистрации автомобиля
  - FuelType — тип топлива
  - Brand — марка автомобиля
  - Repaired — была машина в ремонте или нет
  - DateCreated — дата создания анкеты
  - NumberOfPictures — количество фотографий автомобиля
  - PostalCode — почтовый индекс владельца анкеты (пользователя)
  - LastSeen — дата последней активности пользователя

## В процессе проекта решены следующие задачи:
1. Загружены и изучены исторические данные объявлений о продажах автомобилей
2. Выполнен EDA, включая:
  - проверку и переименование названий столбцов (приведение к стилю under_score)
  - проверку корректности назначенных типов данных (изменены столбецы с датами)
  - поиск полных и неявных дубликатов (4 полных дубликата удалено, неявные дубликаты не выявлены)
  - поиск и заполнение пропусков (во всех номинативных переменных пропуски заполнены строкой unknown)
  - выявление аномальных значений, обнаружены:
      - некорректные значения в столбце год регистрации (reg_year), все строки с ними удалены;
      - записи о машинах, зарегистрированных в 2016 году, по которым отсутствует полная информация о цене и т.д., записи удалены;
      - записи из периода создания объявления, который не охвачен преставленной в ДФ информацией, строки с периодом создания с 2014 по 2015 год удалены из основного ДФ;
      - не "используемый" столбец numb_of_pic (во всех строчках значение - 0), столбец исключен из ДФ;
      - странная "дискретность" величины пробега (целесообразно уточнить у заказчика)
      - странное очень весомое преобладание машин, с величиной пробега 15000 (целесообразно уточнить у заказчика)
      - большое количество неправдоподобно маленьких цен для автомобилей с пробегом 5000 км, записи исключены из ДФ;
      - крайне маленькие и крайне большие величины мощности двигателей, записи удалены из ДФ;
  - изучение характерных взаимосвязей, выявлена:
      - интересная циклическая связь между медианной ценой и датой создания/загрузки объявления
      - положительная, близкая к линейной связь между ценой и мощностью двигателя
      - отрицательная, близкая к линейной связь между ценой и пробегом
      - полиномиальная связь между ценой и годом регистрации автомобиля
  - снижение размерности номинативных данных:
      - малочисленные типы топлива объединены в группу другие
      - малочисленные типы брэндов авто стратифицированы в три группы по величине медианной цены для данного брэнда (другие с низкой ценой, другие с высокой ценой, другие со средней ценой)
      - модели авто, связанные с ранее стратифицированными брэндами, объединены в три группы(другие с низкой ценой, другие с высокой ценой, другие со средней ценой)
  - удалены неинформативные столбцы, затрудняющие обучение моделей (столбцы с датами, столбец с числом картинок)
  - поиск коррелированых столбцов (мультиколлиарность не выявлена)
2. Проведена подготовка данных к машинному обучению:
  - сформированы списки зависимых и независимых признаков для машинных моделей:
  - добавлен еще один целевой признак (логорифм цены)
  - выборка разделена на обучающую и тестовую;
  - проведено масштабирование количественных признаков методом preprocessing.MinMaxScaler
3. Подuотовлена функция, автоматизирующая перебор гиперпараметров на основе метода GridSearch и кросс-валидации.
4. Проведено машинное обучение:
  - созданы базовые (без перебора гиперпараметров) модели:
     - ElasticNet
     - DecisionTreeRegressor
     - LightGBM
     - GAM
  - подобраны гиперпараметры для указанных моделей, оценена метрика качества, полученная на обучающей выборке
  - лучшие модели с оптимальными гиперпараметрами проверены на тестовой выборке.
5. По результатам сравнение результатов, установлено, что лучшей моделью является DecisionTreeRegressor:
  - RMSE на тестовой выборке 1876.754215 
  - время обучения 0.190479 (сек)
  - время предсказания 0.020762 (сек)

## Примечание:
Для улучшения качества работы приложения рекомендуетя:
- задать ограничения на ввод данных в формы объявлений:
  - по году регистрации: с 1980 - по настоящее время
  - по мощности двигателя: от 20 до 500 л.с.
- уточнить природу дискретности пробега
- уточнитьприроду появления околонулевых цен
- уточнить природу появления большого кол-ва записей с пробегом, равным 15000

## Как можно доработать проект:
- пропробовать применить другие методы обработки аномальных значений: устанавливать их равными 0 и создавать дополнительный столбец с меткой об "аномальности" обработанного значения;
- проиллюстрировать результативность предсказаний модели графиком Residuals plot (связь между остатками модели и предсказанными значениями).
