# Учебный проект модуля "Машинное обучение в бизнесе". Определение наиболее выгодного региона нефтедобычи
## Цель проекта: 
По результатам оценки исходных данных о характеристиках трех регионов нефтедобычи выбрать один регион, в котором риск операционных убытков будет минимален, а вероятность получения наибольшей средней прибыли максимален. 

## Задачи проекта:
- применить модель Линейной регрессии (задана в ТЗ) для предсказания объема добычи топлива для всех скважин каждого региона;
- реализовать технику bootstrep для формирования распределений оценки средней операционной прибыли от нефтедобычи в каждом регионе;
- выбрать наиболее перспективный регион нефтедобычи основываясь на статистических оценках полученных выборок

## Заданный ТЗ алгоритм оценки:
В каждом регионе нефтедобычи исследуется по 500 скважин методом Bootstrep. Внутри каждой группы (пятисотки): 
1. Из 500 скважин при помощи МЛ (методом линейной регрессии) выбирается 200 лучших для разработки 
2. Для каждой из отобранных скважин рассчитывается доход (450 000 * кол-во баррелей в скважине)
3. Рассчитывается суммарный доход (200*поскважинный доход)
4. Рассчитывается операционная прибыль(суммарный доход - бюджет на разработку)
5. Оценивается полученное распределение оценки предполагаемой операционной прибыли.Оценивается вероятность отрицательной операционной прибыли (квантили, pvalue)
6. Принимается решение о том, целесообразно ли исследовать данный региона (если Вероятность убытка < 2.5%)
7. Среди оставшихся регионов проводится сравнение оценок средних значений прибыли. 
8. Выбирается лучший регион. 

## Описание данных:
Для анализа предоставлены пробы нефти (характеристики) для каждой скважины в трёх регионах. В данных содержаться:
 - id — уникальный идентификатор скважины;
 - f0, f1, f2 — три признака скважин (неважно, что они означают, но сами признаки значимы);
 - product — объём запасов в скважине (тыс. баррелей).

## В процессе исследования решены следующие задачи:
1. Загружены и изучены данные о скважинах в трех регионах
    - определены форма распределения признаков и целевой переменной
    - проверена взаимная корреляция признаков
2. Выполнена предобработка, включая:
   - переименование названия столбца (с product на oil, так как имя product используется в библиотете pandas)
   - проверку корректности назначенных типов данных (некорректных назначений не выявлено)
   - поиск полных и неявных дубликатов (удалено 30 неявных дубликатов)
   - поиск и заполнение пропусков (не выявлено)
   - выявление аномальных значений (не выявлено)
   - удаление неинформативных столбцов, затрудняющих обучение моделей ('id')
4. Подготовлены данные для машинного обучения:
    - данные разбиты на обучающую и валидационную выборки в соотношении 75:25
    - создана и обучена на обучающей выборке модель стандартизатора
    - выполнено масштабирование обеих выборок
5. Выполнена подготовка к машинному обучению:
    - подготовлена и обучена модель линейной регрессии
    - модель обучена на тренировочной выборке, выбраны лучшие гиперпараметры
    - получены предсказания на тестовой выборке
6. Проведено сравнение предсказанных и фактических показателей запасов сырья:
    - построены диаграммы размаха (для фактических и предсказанных значений)
    - рассчитаны средние значения
    - сформированы выводы, отмечено, что:
        - во всех регионах предсказания не выходят за границы фактических значений (то есть риск того, что предсказание будет намного превышать фактические запасы топлива минимален)
        - во всех регионах средние значения предсказаний очень близки к фактическим средним
        - самые точные предсказания в первом регионе, что обусловлено сильной положительной связью признака и целевого признака
        - в нулевом и во втором регионах отмечается значительное количество выбросов, симметричных относительно медианы.
7. Проведена подготовка к расчету прибыли
    - заданы константы, необходимые для расчета
    - оформлена функция для расчета прибыли
    - методом bootstrep сформированы выборки для расчета оценки средней прибыли 
8. На основании сформированного массива оценок средней прибыли определены:
    - доверительные интервалы средней прибыли
    - вероятность убытков
    - построены графики распределения плотности вероятности оценки прибыли
    - приведено описание построенных графиков, отмечено, что:
      1.  Среднее значение прибыли больше всего в первом (среднем) регионе, при этом дисперсия в этом регионе самая маленькая, а значит разброс вероятных значений прибыли вокруг среднего также небольшой.Установившийся баланс между большой модой и маленькой дисперсией позволяет занимать региону последнее место по вероятности убытков (менее 1.5 %).
      2. В остальных регионах мода распределения ниже, а дисперсия выше, что логичным образом увеличивает шансы возникновения ситуации, когда чистая прибыли по региону будет меньше 10 млрд, а значит разработка региона станет убыточной
      3. С учетом изложенного, самым перспективным представляется первый (средний) регион. В нем идеальное соотношение величины моды, дисперсии и границы доверительного интервала, что позволяет с большей вероятностью ожидать в нем риски убытков, меньше 1.5%
  
9. Основании полученных характеристик оценок средней прибыли выбран наиболее перспективный регион - первый.

Все данные, параметры и объекты обученных моделей зафиксированы в словаре regions_dict
