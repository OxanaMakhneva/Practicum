Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час.

1  Описание проекта
Компании «Чётенькое такси» необходимо предоставить решение, позволяющее прогнозировать количество заказов на следующий час для привлечения водителей в периодыпиковой нагрузки.

1.1  Цель проекта:
На основании предоставленных исторических данных подобрать модель, предсказывающую количество предстоящих заказов. Метрикой качества принять RMSE, которое на тестовой выборке должно быть не больше 48.

1.2  Задачи проекта:
Загрузить данные и выполнить их ресемплирование по одному часу.
Проанализировать данные.
Обучить разные модели с различными гиперпараметрами. Сделать тестовую выборку размером 10% от исходных данных.
Проверить данные на тестовой выборке и сделать выводы.
1.3  Описание данных
Данные лежат в файле taxi.csv.
Количество заказов находится в столбце num_orders (от англ. number of orders, «число заказов»).
1.4  Этапы проекта:
Исследование данных:
загрузка данных
оценка данных (типы переменных, типы категорий (номинативная, количественная))
Предъобработка данных:
проверка и переименование названий столбцов
обработка дат
проверка и заполнение пропусков
проверка на дубликаты (полные, неполные)
проверка на мультиколлинеарность (выявление коррелированных столбцов, выборочное исключение при необходимости)
выявление и исключение аномальных значений (выводы внести в ТЗ приложения)
стратификация по близким признакам (при необходимости)
Исследование данных на предмет применимости для машинного обучения
изучение признаков и целевой переменной
изучение распределений для количественных переменных (оценка формы, близость к нормальному)
изучение возможных взаимосвязей между независимыми и зависимой переменной
выбор функции связи и преобразование целевой переменной (при необходимости)
кодирование номинативных переменных (с присвоением рангов, методом однопроходного кодирования)
масштабирование количественных переменных
Машинное обучение с учителем
подготовка функции, реализующей выбор лучших гиперпараметров с использованием метода GridSearch и кроссвалидации, минимизирующей риски переобучения моделей
разделение обработанного ДФ на обучающую и тестовую повыборки
подбор гиперпараметров с помощью метода кроссвалидации
проверка моделей на тестовой выборке
выбор лучщей модели с учетом критериев заказчика




Целью исследования было подготовить модель расчета количества заказов такси на следующий час. Модель должна была быть разработана на основании исследования исторических данных о ранее сделанных заказах(предосталены в csv файле). Показателем качества модели требовалось принять RMSE, которая должна быть меньше 48 на тестовых данных. При выборе модели важны:

точность предсказания
В процесе исследования:

Загружены и изучены исторические данные о сделанных заказах
Исследованы загруженные данные, определена их форма, типы, смысловая нагрузка
Выполнен EDA, включая:
проверку корректности назначенных типов данных (изменены столбецы с датами)
поиск полных и неявных дубликатов (не выявлены)
поиск и заполнение пропусков (не выявлены)
выявление аномальных значений (не выявлены)
изучение характерных взаимосвязей, выявлена:
слабая связь между количеством заказов и днем недели;
весомая связь между количеством заказов и временем суток;
положительная линейная связь между количеством заказов и месяцем;
Проведена подготовка данных к машинному обучению:
в данные добавлены календарные признаки (деньнедели, час, месяц, время суток, скользящее среднее с окном в три часа)
сформированы списки зависимых и независимых признаков для машинных моделей:
выборка разделена на обучающую и тестовую;
проведено масштабирование количественных признаков методом preprocessing.StandartScaler
Подготовлена функция, автоматизирующая перебор гиперпараметров на основе метода GridSearch и кросс-валидации с использованием временного сплиттера TimeSeriesSplit.
Подготовлены вспомогательные функции для:
заполнения ДФ срезультатами
визуализации значимости признаков
тестирования моделей на тестовой выборке
Проведено машинное обучение:
созданы модели:
ElasticNet
DecisionTreeRegressor
RandomForestRegressor
GAM
подобраны гиперпараметры для указанных моделей, оценена метрика качества, полученная на обучающей выборке
модели с оптимальными гиперпараметрами проверены на тестовой выборке.
8.По результатам сравнение результатов, установлено, что лучшей моделью является RandomForestRegressor c RMSE на тестовой выборке 43.99
